{% extends "rules/__base.html" %}
{% load i18n %}

{% block headtitle %}{% trans 'Bundles &middot; Silent Dune' noop %}{% endblock %}

{% block page-content %}

  <ol class="breadcrumb">
    <li><a href="/dashboard/">Dashboard</a></li>
    <li><a href="/alert/alerts/">Alerts</li></a>
  </ol>


  <h3 class="page-header">Alerts</h3>

  <span style="float: right; margin-top: -52px; font-size: large;" class="glyphicon glyphicon-question-sign"></span>

  <div style="margin-bottom: 10px; display: block;">
    <form id="bundle_search"  role="form" method="POST" action="#"  >{% csrf_token %}
      <input type="text" placeholder="Search Nodes" name="search_term"> &nbsp;<button type="submit" ><span class="glyphicon glyphicon-search"></span></button>
    </form>  
  </div>

  <div class="row">
    <div class="col-sm-12 col-md-12 col-lg-12">
      <table class="table table-striped">
        <thead>
          <tr>
            <th></th>
            <th>Time Stamp</th>
            <th>Destination IP</th>
            <th>Port</th>
            <th>Protocol</th>
            <th>IP Version</th>
            <th>Description</th>
            <th>Options</th>
          </tr>
        </thead>
        {% for alert in alerts %}
        <tr>
          <td><span class="badge">{{alert.total}}</span></td>
          <td><span style='margin-left: 10px;'>{{ alert.time_stamp }}</span></td>
          <td>{{ alert.destination_ip }}</td>
          <td>{{ alert.port }}</td>
          <td>{{ alert.protocol }}</td>
          <td>{{ alert.ip_version }}</td>
          <td>{{ alert.descr }}</td>
          <td>
            <div class="btn-group" role="group" aria-label="...">
              <a href="/alert/alerts/{% if breakout %}0{% endif %}{{ alert.id }}/view/" class="btn btn-default btn-xs"><span class="glyphicon glyphicon-eye-open"></span></a>
            </div>
          </td>
        </tr>        
        {% endfor %}
        
      </table>
      <div class="pagination" style="text-align: center;">
          <span class="step-links">
              {% if alerts.has_previous %}
                  <a href="?page={{ alerts.previous_page_number }}">PREVIOUS&nbsp;&nbsp;</a>
              {% endif %}

              <span class="current">
                  Page {{ alerts.number }} of {{ alerts.paginator.num_pages }}.
              </span>

              {% if alerts.has_next %}
                  <a href="?page={{ alerts.next_page_number }}">&nbsp;&nbsp;NEXT</a>
              {% endif %}
          </span>
      </div>      
      
    </div>
  </div>



{% endblock page-content %}

{% block script %}
<script>

function delete_node()
{
   var delete_node = false;
   
   delete_node = confirm("Are you sure you want to delete this node?")
   return delete_node;
}

</script>


{% endblock script %}
