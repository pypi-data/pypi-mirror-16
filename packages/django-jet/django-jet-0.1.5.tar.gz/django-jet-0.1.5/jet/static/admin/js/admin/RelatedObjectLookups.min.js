function html_unescape(e){return e=e.replace(/&lt;/g,"<"),e=e.replace(/&gt;/g,">"),e=e.replace(/&quot;/g,'"'),e=e.replace(/&#39;/g,"'"),e=e.replace(/&amp;/g,"&"),e}function id_to_windowname(e){return e=e.replace(/\./g,"__dot__"),e=e.replace(/\-/g,"__dash__"),e}function windowname_to_id(e){return e=e.replace(/__dot__/g,"."),e=e.replace(/__dash__/g,"-"),e}function showAdminPopup(e,t){var n=e.id.replace(t,"");n=id_to_windowname(n);var r=e.href;return r.indexOf("?")==-1?r+="?_popup=1":r+="&_popup=1",showRelatedPopup(n,r),!1}function showRelatedObjectLookupPopup(e){return showAdminPopup(e,/^lookup_/)}function dismissRelatedLookupPopup(e,t){var n=windowname_to_id(e.name),r=document.getElementById(n);r.className.indexOf("vManyToManyRawIdAdminField")!=-1&&r.value?r.value+=","+t:document.getElementById(n).value=t,closeRelatedPopup(e)}function showRelatedObjectPopup(e){var t=e.id.replace(/^(change|add|delete)_/,"");t=id_to_windowname(t);var n=e.href;return n.indexOf("_popup=1")==-1&&(n.indexOf("?")==-1?n+="?_popup=1":n+="&_popup=1"),showRelatedPopup(t,n),!1}function dismissAddRelatedObjectPopup(e,t,n){t=html_unescape(t),n=html_unescape(n);var r=windowname_to_id(e.name),i=document.getElementById(r),s;if(i){var o=i.nodeName.toUpperCase();o=="SELECT"?(s=new Option(n,t),i.options[i.options.length]=s,s.selected=!0):o=="INPUT"&&(i.className.indexOf("vManyToManyRawIdAdminField")!=-1&&i.value?i.value+=","+t:i.value=t),django.jQuery(i).trigger("change")}else{var u=r+"_to";s=new Option(n,t),SelectBox.add_to_cache(u,s),SelectBox.redisplay(u)}closeRelatedPopup(e)}function dismissChangeRelatedObjectPopup(e,t,n,r){t=html_unescape(t),n=html_unescape(n);var i=windowname_to_id(e.name).replace(/^edit_/,""),s=interpolate("#%s, #%s_from, #%s_to",[i,i,i]),o=django.jQuery(s);o.find("option").each(function(){this.value==t&&(this.innerHTML=n,this.value=r)}),closeRelatedPopup(e)}function dismissDeleteRelatedObjectPopup(e,t){t=html_unescape(t);var n=windowname_to_id(e.name).replace(/^delete_/,""),r=interpolate("#%s, #%s_from, #%s_to",[n,n,n]),i=django.jQuery(r);i.find("option").each(function(){this.value==t&&django.jQuery(this).remove()}).trigger("change"),closeRelatedPopup(e)}function showRelatedPopup(e,t){django.jQuery(function(n){var r=n(".related-popup-container",parent.document),i=r.find(".loading-indicator",parent.document),s=n("body").addClass("non-scrollable",parent.document),o=n("<iframe>").attr("name",e).attr("src",t).addClass("related-popup").on("load",function(){o.add(n(".related-popup-back")).fadeIn(200,"swing",function(){i.hide()})});i.show(),r.fadeIn(200,"swing",function(){r.append(o)}),s.addClass("non-scrollable",parent.document)})}function closeRelatedPopup(e){jet.jQuery("select").trigger("select:init"),jet.jQuery(e.parent).trigger("related-popup:close")}showAddAnotherPopup=showRelatedObjectPopup,dismissAddAnotherPopup=dismissAddRelatedObjectPopup,opener=parent.window,django.jQuery(document).ready(function(){jet.jQuery(function(e){function t(){var t=e(this),n=t.nextAll(".change-related, .delete-related");if(!n.length)return;var r=t.val();r?n.each(function(){var t=e(this);t.attr("href",t.attr("data-href-template").replace("__fk__",r))}):n.removeAttr("href")}var n=e(document);n.on("change",".related-widget-wrapper select",t),n.find(".related-widget-wrapper select").each(t),n.on("click",".related-widget-wrapper-link",function(e){this.href&&showRelatedObjectPopup(this),e.preventDefault()})})});
