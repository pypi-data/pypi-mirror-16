#!python

import os
import sys
from argparse import ArgumentParser

MY_DIRECTORY = os.path.abspath(os.path.dirname(__file__))
sys.path.append(
    os.path.abspath(os.path.join(MY_DIRECTORY, '..'))
)

from cauldron.cli import server
from cauldron.cli.commands import version

parser = ArgumentParser(
    description='Cauldron server'
)

parser.add_argument(
    '-p', '--port',
    dest='port',
    type=int,
    default=5010
)

parser.add_argument(
    '-d', '--debug',
    dest='debug',
    default=False,
    action='store_true'
)

parser.add_argument(
    '-v', '--version',
    dest='version',
    default=False,
    action='store_true'
)

args = parser.parse_args()

if args.version:
    data = version.get_package_data()
    print('VERSION: {}'.format(data['version']))
    sys.exit(0)

server.run(port=args.port, debug=args.debug)

