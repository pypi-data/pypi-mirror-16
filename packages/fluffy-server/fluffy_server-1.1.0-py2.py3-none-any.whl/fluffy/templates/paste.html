{% set page_name = 'paste' %}
{# This templates gets uploaded as HTML to the CDN; #}
{# Debug mode will always give us invalid relative URLs. #}
{% set allow_debug = False %}
{% extends 'layouts/base.html' %}

{% block head_extra %}
    <link href='https://fonts.googleapis.com/css?family=Source+Code+Pro:500,700' rel='stylesheet' type='text/css'>
{% endblock %}

{% block content %}
    <div id="paste">
        <div class="line-numbers">
            {% for i in range(1, num_lines(text) + 1) %}
                <a href="#L{{i}}" id="L{{i}}">{{i}}</a>
            {% endfor %}
        </div>
        <div class="text" contenteditable="true" spellcheck="false">
            {{text|highlight(language=language)|safe}}</pre>
        </div>
    </div>
{% endblock %}

{% block inline_js %}
    <!-- TODO: can we factor out jQuery? -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <script>
        var whitelistedKeys = [
            // arrow keys
            37, 38, 39, 40,

            // home/end
            35, 36,

            // page up/down
            33, 34,
        ];
        $(document).ready(function() {
            $('#paste').on('keydown', function(e) {
                if (e.ctrlKey) {
                    return true;
                }
                if ($.inArray(e.which, whitelistedKeys) !== -1) {
                    return true;
                }
                return false;
            });
        });
    </script>
{% endblock %}
